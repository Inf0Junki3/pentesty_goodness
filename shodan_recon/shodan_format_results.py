import json
from termcolor import colored

with open("shodan_results.json") as resultfile:
    results = json.load(resultfile)

for result_ip, result_val in results.iteritems():
    if type(result_val) is dict:
        print colored(result_ip, "blue")
        for item in result_val["data"]:
            if "vulns" in result_val.keys() and len(result_val["vulns"]) > 0:
                print colored("Vulnerabilities: {}".format(", ".join(result_val["vulns"])), "red")
            print colored(item["port"], "yellow")
            if len(result_val["hostnames"]) > 0:
                print colored("Host names: {}".format(", ".join(result_val["hostnames"])), "green")
            print item["data"]
